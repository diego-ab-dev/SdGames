<!DOCTYPE html>
{% load static %}
{% load custom_filters %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"></script>
    <link rel="stylesheet" href="{% static 'styles/styles_perfil_usuario.css' %}">
    <link rel="icon" type="image/png" href="{% static 'images/sdgameslogo.png' %}">
    <title>Perfil - {{ usuario.nombre }}</title>
</head>
<body>
    <div class="container justify-content-center">
        <div class="main-body">
          <h1 class="text-center fst-italic fw-bold" style="margin-bottom: 40px;">Bienvenido/a, {{ usuario.nombre }}</h1>
          <button onclick="window.location.href='/menu'">
            <svg height="16" width="16" xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 1024 1024"><path d="M874.690416 495.52477c0 11.2973-9.168824 20.466124-20.466124 20.466124l-604.773963 0 188.083679 188.083679c7.992021 7.992021 7.992021 20.947078 0 28.939099-4.001127 3.990894-9.240455 5.996574-14.46955 5.996574-5.239328 0-10.478655-1.995447-14.479783-5.996574l-223.00912-223.00912c-3.837398-3.837398-5.996574-9.046027-5.996574-14.46955 0-5.433756 2.159176-10.632151 5.996574-14.46955l223.019353-223.029586c7.992021-7.992021 20.957311-7.992021 28.949332 0 7.992021 8.002254 7.992021 20.957311 0 28.949332l-188.073446 188.073446 604.753497 0C865.521592 475.058646 874.690416 484.217237 874.690416 495.52477z"></path></svg>
            <span>Volver al Menu</span>
          </button>
              <div class="row gutters-sm">
                <div class="col-md-4 mb-3">
                  <div class="card">
                    <div class="card-body" style="background-color: #b8b8b9; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);">
                      <div class="d-flex flex-column align-items-center text-center">
                        <div class="mt-3">
                          <h1 class="fs-4 fst-italic fw-bold">Mis Compras</h1>
                          <div class="row">
                              {% for compra in compras %}
                                  <div class="row-md-2">
                                      <div class="card mb-3">
                                          <div class="card-body" style="background-color: #2c2e33; color: azure; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);">
                                              <h5 class="card-title">Compra #{{ compra.id }}</h5>
                                              <p class="card-text">Total: ${{ compra.total|formato_chileno }}</p>
                                              <p class="card-text">Fecha: {{ compra.fecha|date:"d/m/Y H:i" }}</p>
                                              <p class="card-text">Estado: {{ compra.estado }}</p>
                                          </div>
                                      </div>
                                  </div>
                              {% endfor %}
                          </div>
                          <div class="row">
                              <div class="col text-center">
                                <a href="{% url 'ver_compras' %}">
                                  <button class="learn-more">
                                    <span class="circle" aria-hidden="true">
                                    <span class="icon arrow"></span>
                                    </span>
                                    <span class="button-text">Ver más</span>
                                  </button>
                              </a>
                              </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-md-8">
                  <div class="card mb-3">
                    <div class="card-body" style="background-color: #b8b8b9;">
                      <div class="row">
                        <div class="col-sm-3">
                          <h6 class="mb-0 fw-bold">Nombre</h6>
                        </div>
                        <div class="col-sm-9">
                            {{ usuario.nombre }}
                        </div>
                      </div>
                      <hr>
                      <div class="row">
                        <div class="col-sm-3">
                          <h6 class="mb-0 fw-bold">Correo Electrónico</h6>
                        </div>
                        <div class="col-sm-9">
                            {{ usuario.email }}
                        </div>
                      </div>
                      <hr>
                      <div class="row">
                        <div class="col-sm-3">
                          <h6 class="mb-0 fw-bold">Rut</h6>
                        </div>
                        <div class="col-sm-9">
                            {{ usuario.rut }}
                        </div>
                      </div>
                      <hr>
                      <div class="row">
                        <div class="col-sm-3">
                          <h6 class="mb-0 fw-bold">Teléfono</h6>
                        </div>
                        <div class="col-sm-9">
                            {{ usuario.telefono }}
                        </div>
                      </div>
                      <hr>
                      <div class="row">
                        <div class="col-sm-3">
                          <h6 class="mb-0 fw-bold">Dirección</h6>
                        </div>
                        <div class="col-sm-9">
                            {{ usuario.direccion }}
                        </div>
                      </div>
                      <hr>
                      <div class="row">
                        <div class="col-sm-3">
                          <h6 class="mb-0 fw-bold">Region</h6>
                        </div>
                        <div class="col-sm-9">
                            {{ usuario.region }}
                        </div>
                      </div>
                      <hr>
                      <div class="row">
                        <div class="col-sm-3">
                          <h6 class="mb-0 fw-bold">Ciudad</h6>
                        </div>
                        <div class="col-sm-9">
                            {{ usuario.ciudad }}
                        </div>
                      </div>
                      <hr>
                      <div class="row gx-5">
                        <div class="col">
                          <a href="{% url 'editar' %}" id="edit-button" class="Btn mt-2">
                            Editar Perfil
                            <svg class="svg" viewBox="0 0 512 512">
                                <path d="M410.3 231l11.3-11.3-33.9-33.9-62.1-62.1L291.7 89.8l-11.3 11.3-22.6 22.6L58.6 322.9c-10.4 10.4-18 23.3-22.2 37.4L1 480.7c-2.5 8.4-.2 17.5 6.1 23.7s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L387.7 253.7 410.3 231zM160 399.4l-9.1 22.7c-4 3.1-8.5 5.4-13.3 6.9L59.4 452l23-78.1c1.4-4.9 3.8-9.4 6.9-13.3l22.7-9.1v32c0 8.8 7.2 16 16 16h32zM362.7 18.7L348.3 33.2 325.7 55.8 314.3 67.1l33.9 33.9 62.1 62.1 33.9 33.9 11.3-11.3 22.6-22.6 14.5-14.5c25-25 25-65.5 0-90.5L453.3 18.7c-25-25-65.5-25-90.5 0zm-47.4 168l-144 144c-6.2 6.2-16.4 6.2-22.6 0s-6.2-16.4 0-22.6l144-144c6.2-6.2 16.4-6.2 22.6 0s6.2 16.4 0 22.6z"></path>
                            </svg>
                          </a>
                        </div>
                        <div class="col">
                          <a href="{% url 'cambiar' %}" id="edit-button" class="Btn mt-2">
                            Cambiar Contraseña
                            <svg class="svg" viewBox="0 0 512 512">
                                <path d="M410.3 231l11.3-11.3-33.9-33.9-62.1-62.1L291.7 89.8l-11.3 11.3-22.6 22.6L58.6 322.9c-10.4 10.4-18 23.3-22.2 37.4L1 480.7c-2.5 8.4-.2 17.5 6.1 23.7s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L387.7 253.7 410.3 231zM160 399.4l-9.1 22.7c-4 3.1-8.5 5.4-13.3 6.9L59.4 452l23-78.1c1.4-4.9 3.8-9.4 6.9-13.3l22.7-9.1v32c0 8.8 7.2 16 16 16h32zM362.7 18.7L348.3 33.2 325.7 55.8 314.3 67.1l33.9 33.9 62.1 62.1 33.9 33.9 11.3-11.3 22.6-22.6 14.5-14.5c25-25 25-65.5 0-90.5L453.3 18.7c-25-25-65.5-25-90.5 0zm-47.4 168l-144 144c-6.2 6.2-16.4 6.2-22.6 0s-6.2-16.4 0-22.6l144-144c6.2-6.2 16.4-6.2 22.6 0s6.2 16.4 0 22.6z"></path>
                            </svg>
                          </a>
                        </div>
                    </div>
                  </div>
                </div>
                <div class="row gutters-sm">
                  <div class="col-sm-6 mb-3">
                    <div class="card h-100">
                        <div class="card-body" style="background-color: #b8b8b9; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);">
                            <h1 class="fs-4 fst-italic fw-bold text-center">Mis opiniones</h1>
                            {% if opiniones %}
                                <ul>
                                    {% for opinion in opiniones %}
                                        <li>
                                            <strong>{{ opinion.producto.nombre }}</strong>: 
                                            {{ opinion.comentario }} ({{ opinion.puntuacion }} estrellas)
                                        </li>
                                    {% endfor %}
                                </ul>
                                <div class="row">
                                  <div class="col text-center">
                                    <a href="{% url 'lista_opiniones' %}">
                                      <button class="learn-more">
                                        <span class="circle" aria-hidden="true">
                                        <span class="icon arrow"></span>
                                        </span>
                                        <span class="button-text">Ver más</span>
                                      </button>
                                  </a>
                                  </div>
                              </div>
                            {% else %}
                                <p>No tienes opiniones ingresadas.</p>
                                <button class="btn btn-secondary" disabled>Ver más</button>
                            {% endif %}
                        </div>
                    </div>
                </div>                
                <div class="col-sm-6 mb-3">
                  <div class="card h-100">
                    <div class="card-body" style="background-color: #b8b8b9; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);">
                      <h1 class="fs-4 fst-italic fw-bold text-center">Mis reclamos</h1>
                      <ul class="list-group list-group-flush">
                        {% for reclamo in reclamos_recientes %}
                            <li class="list-group-item" style="background-color: #2c2e33; color: azure; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);">
                                <p class="mb-1"><strong>Estado:</strong> {{ reclamo.estado }}</p>
                                <p class="mb-1"><strong>Descripción:</strong> {{ reclamo.descripcion }}</p>
                                <p class="mb-1"><strong>Fecha:</strong> {{ reclamo.fecha|date:"d-m-Y H:i" }}</p>
                            </li>
                        {% empty %}
                            <li class="list-group-item">No hay reclamos recientes.</li>
                        {% endfor %}
                      </ul>
                      <div class="d-grid gap-2 mt-3">
                        <div class="row">
                          <div class="col text-center">
                            <a href="{% url 'lista_reclamos' %}">
                              <button class="learn-more">
                                <span class="circle" aria-hidden="true">
                                <span class="icon arrow"></span>
                                </span>
                                <span class="button-text">Ver más</span>
                              </button>
                          </a>
                          </div>
                      </div>
                      </div>
                    </div>
                  </div>
                </div>                
                </div>
              </div>
    
            </div>
        </div>
</body>
</html>